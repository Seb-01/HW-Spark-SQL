# HW-Spark-SQL
ДЗ по занятию "Spark SQL"

За последнюю неделю марта 2021 считал 29-31 марта (с понедельника по среду)

Результаты (лучше смотреть в режиме редактирования):
1. Выберите 15 стран с наибольшим процентом переболевших на 31 марта (в выходящем датасете необходимы колонки: iso_code, страна, процент переболевших)
+--------+--------------+-------------------+
|iso_code|      location|             result|
+--------+--------------+-------------------+
|     VAT|       Vatican| 0.7416563658838072|
|     SMR|    San Marino| 0.6953857033413873|
|     AND|       Andorra| 0.4866368989840161|
|     LUX|    Luxembourg| 0.3479366621084514|
|     ISL|       Iceland| 0.3326007326007326|
|     ESP|         Spain|0.20516189755388237|
|     CHE|   Switzerland|0.19186288753587968|
|     LIE| Liechtenstein|0.17830453365498072|
|     ITA|         Italy| 0.1749732078891164|
|     MCO|        Monaco|0.13250433187238814|
|     AUT|       Austria|0.11303073370047965|
|     BEL|       Belgium|0.11022798339479065|
|OWID_EUN|European Union|0.08938996679530879|
|     DEU|       Germany|0.08570615766540952|
|     NOR|        Norway|0.08560768916052816|
+--------+--------------+-------------------+
only showing top 15 rows

2. Top 10 стран с максимальным зафиксированным кол-вом новых случаев за последнюю неделю марта 2021 в отсортированном порядке по убыванию (в выходящем датасете необходимы колонки: число, страна, кол-во новых случаев)
+--------------+----------+--------------+
|      location|      date|max(new_cases)|
+--------------+----------+--------------+
|        Europe|2021-03-31|      255985.0|
|European Union|2021-03-31|      216452.0|
|        Europe|2021-03-30|      204845.0|
|          Asia|2021-03-31|      183350.0|
|European Union|2021-03-30|      162338.0|
|          Asia|2021-03-30|      161222.0|
|          Asia|2021-03-29|      152824.0|
| South America|2021-03-31|      145976.0|
|        Europe|2021-03-29|      139257.0|
| South America|2021-03-30|      117245.0|
+--------------+----------+--------------+

3. Посчитайте изменение случаев относительно предыдущего дня в России за последнюю неделю марта 2021. (например: в россии вчера было 9150 , сегодня 8763, итог: -387) (в выходящем датасете необходимы колонки: число, кол-во новых случаев вчера, кол-во новых случаев сегодня, дельта)
+----------+---------+--------+------+
|      date|new_cases|prev_day| delta|
+----------+---------+--------+------+
|2021-03-29|   8589.0|    NULL|  NULL|
|2021-03-30|   8162.0|  8589.0|-427.0|
|2021-03-31|   8156.0|  8162.0|  -6.0|
+----------+---------+--------+------+


   
